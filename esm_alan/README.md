# ESM
Generate ESM embeddings using Facebook's [ESM1B](https://github.com/facebookresearch/esm) model and train a basic neural network. 

## Data
The data contains approximately 120,000 variants and can be found under `/data/hz2529/neo/repos/genetic_variants_data/train/2021_v20/0.csv`. The reference sequences can be found under `/data/hz2529/zion/MVPContext/feature`

The data folder is split into 3 directories under `/data/alant/ESM`.

`fasta_files` contains the variants. `train_var_randomized.fasta` contains all sequences in a randomized order. This file is broken up into smaller subfiles which contain 20,000 variants each. For example, `0.fasta` contains the first 20,000 variants, `20000.fasta` contains the next 20,000 variants, and so on. 

The orig files are the reference sequences. Each file corresponds to the variant in the variant file (ex: `0_orig.fasta` corresponds to `0.fasta`)

The header of each variant sequence is formatted as `index-id-target`. For example, the header `9999-ENST00000558012-1` corresponds to the 9999th sequence in a particular file, and 1 corresponds to the variant being pathogenic. There is no need to label the sequence of the reference sequences, so the header is simply `index-id`

`train_embeddings` contains the embeddings generated by the ESM-1b model. `train_embeddings/mutant` contains embeddings of the mutant variant. There are currently 20,000 variants in this directory. It contains the sequences from `/fasta_files/0.fasta`. Likewise, the `train_embeddings/orig` directory contains the embeddings for the original/reference sequence. It contains sequences from `fasta_files/0_orig.fasta`

A similar structure is used for the `test_embeddings` directory. The embeddings are generated from the files `fasta_files/20000.fasta` and `fasta_files/20000_orig.fasta`.

As of now, only the embeddings from files `0.fasta`,`20000.fasta`,`0_orig.fasta`, and `20000_orig.fasta` have been generated. All embeddings generated are mean embeddings.